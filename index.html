<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Rotational Motion Master Hub</title>
    <style>
        :root {
            --bg: #09090b;
            --card: #18181b;
            --primary: #8b5cf6; /* Violet */
            --accent: #06b6d4; /* Cyan */
            --danger: #ef4444;
            --text: #e4e4e7;
            --border: rgba(255, 255, 255, 0.1);
        }

        body {
            margin: 0;
            overflow: hidden;
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Inter', system-ui, sans-serif;
            user-select: none;
            -webkit-tap-highlight-color: transparent;
        }

        /* --- MAIN MENU --- */
        #menu-screen {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg);
            z-index: 100;
            display: flex;
            flex-direction: column;
            padding: 20px;
            box-sizing: border-box;
            overflow-y: auto;
        }

        .menu-header {
            text-align: center;
            margin-bottom: 30px;
            margin-top: 20px;
        }
        .menu-title { font-size: 2rem; font-weight: 900; background: linear-gradient(to right, var(--primary), var(--accent)); -webkit-background-clip: text; color: transparent; }
        .menu-sub { color: #a1a1aa; font-size: 0.9rem; margin-top: 5px; }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            max-width: 800px;
            margin: 0 auto;
            width: 100%;
        }

        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 16px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
            overflow: hidden;
        }
        .card:active { transform: scale(0.98); background: #27272a; }
        .card::before {
            content: ''; position: absolute; top:0; left:0; width:100%; height:4px;
            background: var(--primary);
        }
        .card-icon { font-size: 2.5rem; margin-bottom: 10px; }
        .card-title { font-weight: 700; margin-bottom: 5px; }
        .card-desc { font-size: 0.75rem; color: #a1a1aa; line-height: 1.3; }

        /* --- SIMULATION CONTAINER --- */
        #sim-container {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: none; /* Hidden by default */
        }
        
        canvas { display: block; width: 100%; height: 100%; }

        /* --- IN-GAME UI --- */
        #game-ui {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .top-bar {
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            pointer-events: auto;
            background: linear-gradient(180deg, rgba(0,0,0,0.8) 0%, transparent 100%);
        }
        .back-btn {
            background: rgba(255,255,255,0.1); border: 1px solid var(--border);
            color: white; padding: 8px 16px; border-radius: 20px; font-weight: 600; cursor: pointer;
            backdrop-filter: blur(4px); font-size: 0.8rem;
        }

        .controls {
            padding: 20px;
            background: rgba(24, 24, 27, 0.95);
            border-top: 1px solid var(--border);
            pointer-events: auto;
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-height: 40vh;
            overflow-y: auto;
        }

        /* Generic Control Styles */
        .c-row { display: flex; justify-content: space-between; align-items: center; font-size: 0.9rem; color: #d4d4d8; }
        .c-val { color: var(--accent); font-family: monospace; font-weight: bold; }
        input[type="range"] { flex: 1; margin-left: 15px; accent-color: var(--primary); }
        .action-btn {
            width: 100%; padding: 12px; border: none; border-radius: 8px;
            background: var(--primary); color: white; font-weight: 700; font-size: 1rem;
            cursor: pointer;
        }
        .action-btn.danger { background: var(--danger); }

        /* Hint Box */
        .concept-pill {
            position: absolute; top: 70px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.6); padding: 8px 16px; border-radius: 20px;
            border: 1px solid var(--accent); color: var(--accent); font-size: 0.8rem;
            pointer-events: none; text-align: center; width: 80%;
        }

    </style>
</head>
<body>

    <div id="menu-screen">
        <div class="menu-header">
            <div class="menu-title">ROTATIONAL LAB</div>
            <div class="menu-sub">JEE Syllabus Interactive Suite</div>
        </div>

        <div class="grid">
            <div class="card" onclick="loadSim('INERTIA')">
                <div class="card-icon">‚öì</div>
                <div class="card-title">Moment of Inertia</div>
                <div class="card-desc">Build a dumbbell. Feel how mass distribution ($mr^2$) affects rotation.</div>
            </div>
            
            <div class="card" onclick="loadSim('COAM')">
                <div class="card-icon">‚õ∏Ô∏è</div>
                <div class="card-title">Angular Momentum</div>
                <div class="card-desc">Conservation law ($L = I\omega$). Change shape to change speed.</div>
            </div>

            <div class="card" onclick="loadSim('TOPPLE')">
                <div class="card-icon">üìê</div>
                <div class="card-title">Torque & Toppling</div>
                <div class="card-desc">Push a block. Will it slide or will it topple? ($\tau$ vs $f$).</div>
            </div>

            <div class="card" onclick="loadSim('RACE')">
                <div class="card-icon">üèÅ</div>
                <div class="card-title">Rolling Race</div>
                <div class="card-desc">Ring vs Disc vs Sphere. Who wins on an incline?</div>
            </div>
        </div>
    </div>

    <div id="sim-container">
        <canvas id="canvas"></canvas>
        <div id="game-ui">
            <div class="top-bar">
                <button class="back-btn" onclick="goHome()">‚Üê MENU</button>
                <div style="font-weight:700; font-size:0.9rem;" id="sim-title">TITLE</div>
            </div>
            <div class="concept-pill" id="sim-concept">Concept Formula</div>
            <div class="controls" id="sim-controls">
                </div>
        </div>
    </div>
    <script>
// --- CORE ENGINE ---
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');
let width, height;
let currentSim = null;
let animId = null;

// Resize
function resize() {
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;
    if(currentSim && currentSim.resize) currentSim.resize();
}
window.addEventListener('resize', resize);
resize();

// Navigation
function loadSim(type) {
    document.getElementById('menu-screen').style.display = 'none';
    document.getElementById('sim-container').style.display = 'block';
    
    cancelAnimationFrame(animId);
    
    // Switcher
    if (type === 'INERTIA') currentSim = new InertiaSim();
    if (type === 'COAM') currentSim = new CoamSim();
    if (type === 'TOPPLE') currentSim = new ToppleSim();
    if (type === 'RACE') currentSim = new RaceSim();

    document.getElementById('sim-title').innerText = currentSim.title;
    document.getElementById('sim-concept').innerText = currentSim.concept;
    currentSim.initUI();
    currentSim.resize();
    
    loop();
}

function goHome() {
    cancelAnimationFrame(animId);
    document.getElementById('sim-container').style.display = 'none';
    document.getElementById('menu-screen').style.display = 'flex';
    currentSim = null;
}

function loop() {
    if(!currentSim) return;
    
    // Clear
    ctx.fillStyle = '#09090b';
    ctx.fillRect(0, 0, width, height);
    
    currentSim.update();
    currentSim.draw();
    
    animId = requestAnimationFrame(loop);
}


// ==========================================
// SIMULATION 1: MOMENT OF INERTIA LAB
// ==========================================
class InertiaSim {
    constructor() {
        this.title = "Moment of Inertia Builder";
        this.concept = "I = Œ£mr¬≤. More radius = Harder to spin.";
        this.masses = []; // {r: distance, m: mass}
        this.angle = 0;
        this.omega = 0;
        this.torque = 0;
    }

    resize() {
        this.cx = width/2;
        this.cy = height/2 - 50;
    }

    initUI() {
        const c = document.getElementById('sim-controls');
        c.innerHTML = `
            <div class="c-row">
                <span>Add Mass Distance ($r$)</span>
                <input type="range" min="10" max="150" value="80" id="in-r">
            </div>
            <button class="action-btn" onclick="currentSim.addMass()">ADD MASS (1kg)</button>
            <div class="c-row">
                <span>Applied Torque ($\tau$)</span>
                <input type="range" min="0" max="50" value="0" oninput="currentSim.torque=parseFloat(this.value)">
            </div>
            <button class="action-btn danger" onclick="currentSim.reset()">RESET</button>
        `;
    }

    addMass() {
        const r = parseFloat(document.getElementById('in-r').value);
        this.masses.push({r: r, m: 1});
    }

    reset() { this.masses = []; this.omega = 0; this.torque = 0; this.angle = 0; }

    update() {
        // I = sum(m*r^2) + I_rod
        // Let rod have basic I
        let I = 1000; // Base inertia
        this.masses.forEach(m => I += m.m * m.r * m.r);

        // alpha = torque / I
        const alpha = (this.torque * 500) / I; // Scale torque up for visuals
        this.omega += alpha;
        this.omega *= 0.98; // Friction
        this.angle += this.omega * 0.1;
    }

    draw() {
        ctx.save();
        ctx.translate(this.cx, this.cy);
        ctx.rotate(this.angle);

        // Draw Rod
        ctx.strokeStyle = '#333';
        ctx.lineWidth = 10;
        ctx.beginPath(); ctx.moveTo(-160,0); ctx.lineTo(160,0); ctx.stroke();
        
        // Draw Center
        ctx.fillStyle = '#8b5cf6';
        ctx.beginPath(); ctx.arc(0,0,15,0,Math.PI*2); ctx.fill();

        // Draw Masses
        this.masses.forEach(m => {
            // Draw symmetric pairs for balance visual
            [1, -1].forEach(side => {
                const x = m.r * side;
                ctx.fillStyle = '#06b6d4';
                ctx.beginPath(); ctx.arc(x, 0, 10 + m.m*2, 0, Math.PI*2); ctx.fill();
            });
        });

        ctx.restore();

        // HUD
        ctx.fillStyle = 'white';
        ctx.font = '20px monospace';
        ctx.textAlign = 'center';
        ctx.fillText(`Angular Vel (œâ): ${this.omega.toFixed(1)}`, this.cx, this.cy + 150);
        
        let I_val = 1000;
        this.masses.forEach(m => I_val += m.m * m.r * m.r);
        ctx.fillStyle = '#a1a1aa';
        ctx.font = '14px monospace';
        ctx.fillText(`Total Inertia (I): ${I_val.toFixed(0)}`, this.cx, this.cy + 180);
    }
}


// ==========================================
// SIMULATION 2: CONSERVATION OF ANGULAR MOMENTUM
// ==========================================
class CoamSim {
    constructor() {
        this.title = "Conservation of L";
        this.concept = "L = Iœâ = Constant. If I drops, œâ rises.";
        this.armLength = 100; // Controls I
        this.angle = 0;
        this.omega = 2; // Initial speed
        this.L = 0; // Calculated on init
    }

    resize() { this.cx = width/2; this.cy = height/2 - 50; }

    initUI() {
        const c = document.getElementById('sim-controls');
        c.innerHTML = `
            <div class="c-row">
                <span>Arm Extension ($r$)</span>
                <input type="range" min="20" max="150" value="100" oninput="currentSim.updateArm(this.value)">
            </div>
            <div style="font-size:0.8rem; color:#666; margin-top:10px;">
                Pull arms in (reduce r) to see speed increase automatically. No external torque!
            </div>
        `;
        // Calc initial L
        this.L = this.calcI(100) * this.omega;
    }

    calcI(r) {
        // Model: Central body + 2 masses at distance r
        return 2000 + (2 * 10 * r * r); 
    }

    updateArm(val) {
        this.armLength = parseFloat(val);
        // COAM Logic: w_new = L / I_new
        const I_new = this.calcI(this.armLength);
        this.omega = this.L / I_new;
    }

    update() {
        this.angle += this.omega * 0.1;
    }

    draw() {
        ctx.save();
        ctx.translate(this.cx, this.cy);
        ctx.rotate(this.angle);

        // Body
        ctx.fillStyle = '#ef4444';
        ctx.beginPath(); ctx.arc(0,0,30,0,Math.PI*2); ctx.fill();

        // Arms
        ctx.strokeStyle = '#fff'; ctx.lineWidth = 5;
        ctx.beginPath(); ctx.moveTo(-this.armLength, 0); ctx.lineTo(this.armLength, 0); ctx.stroke();

        // Hands/Weights
        ctx.fillStyle = '#f59e0b';
        ctx.beginPath(); ctx.arc(-this.armLength, 0, 15, 0, Math.PI*2); ctx.fill();
        ctx.beginPath(); ctx.arc(this.armLength, 0, 15, 0, Math.PI*2); ctx.fill();

        // Trail effect
        if(this.omega > 0.5) {
             ctx.globalAlpha = 0.2;
             ctx.beginPath(); ctx.arc(0,0, this.armLength, 0, Math.PI*2);
             ctx.strokeStyle = '#f59e0b'; ctx.stroke();
             ctx.globalAlpha = 1;
        }

        ctx.restore();

        // Text
        ctx.fillStyle = 'white'; ctx.textAlign = 'center'; ctx.font = '16px monospace';
        ctx.fillText(`Rotational Speed (œâ): ${this.omega.toFixed(2)}`, this.cx, this.cy + 150);
        ctx.fillStyle = '#666';
        ctx.fillText(`Inertia (I): ${this.calcI(this.armLength).toFixed(0)}`, this.cx, this.cy + 175);
    }
}
        // ==========================================
// SIMULATION 3: TORQUE & TOPPLING
// ==========================================
class ToppleSim {
    constructor() {
        this.title = "Toppling vs Sliding";
        this.concept = "Slide if F > Œºmg. Topple if F*h > mg*b/2.";
        this.h = 100; // Height of force
        this.f = 0;   // Applied force
        this.mu = 0.5;
        this.state = "STABLE"; // STABLE, SLIDING, TOPPLING
        
        // Box dims
        this.bw = 100;
        this.bh = 150;
        this.mass = 10;
        this.boxX = 0;
        this.tilt = 0;
    }

    resize() { this.cx = width/2; this.cy = height - 150; this.boxX = this.cx; }

    initUI() {
        const c = document.getElementById('sim-controls');
        c.innerHTML = `
            <div class="c-row">
                <span>Push Height ($h$)</span>
                <input type="range" min="10" max="150" value="100" oninput="currentSim.h=parseFloat(this.value)">
            </div>
            <div class="c-row">
                <span>Friction Coeff ($\mu$)</span>
                <input type="range" min="0.1" max="1.0" step="0.1" value="0.5" oninput="currentSim.mu=parseFloat(this.value)">
            </div>
            <div class="c-row">
                <span>Apply Force ($F$)</span>
                <input type="range" min="0" max="150" value="0" oninput="currentSim.f=parseFloat(this.value)">
            </div>
            <button class="action-btn danger" onclick="currentSim.reset()">RESET BOX</button>
        `;
    }

    reset() { this.f = 0; this.state="STABLE"; this.boxX=this.cx; this.tilt=0; document.querySelectorAll('input')[2].value=0; }

    update() {
        const g = 10;
        const mg = this.mass * g;
        const f_max = this.mu * mg;
        const torque_push = this.f * this.h;
        const torque_restore = mg * (this.bw / 2);

        // Logic
        if (this.state !== "TOPPLING") {
            if (torque_push > torque_restore) {
                this.state = "TOPPLING";
            } else if (this.f > f_max) {
                this.state = "SLIDING";
                this.boxX += 2; // Move box
            } else {
                this.state = "STABLE";
            }
        }

        if(this.state === "TOPPLING") {
            if(this.tilt < Math.PI/2) this.tilt += 0.05;
        } else {
            this.tilt = 0;
        }
        
        // Loop box
        if(this.boxX > width + 50) this.boxX = -50;
    }

    draw() {
        // Floor
        ctx.strokeStyle = '#555'; ctx.beginPath(); ctx.moveTo(0, this.cy); ctx.lineTo(width, this.cy); ctx.stroke();

        ctx.save();
        // Pivot point for toppling is bottom right corner
        const pivotX = this.boxX + this.bw/2;
        const pivotY = this.cy;
        
        ctx.translate(pivotX, pivotY);
        ctx.rotate(this.tilt);
        ctx.translate(-pivotX, -pivotY);

        // Box
        ctx.fillStyle = this.state === "STABLE" ? '#3b82f6' : (this.state === "SLIDING" ? '#f59e0b' : '#ef4444');
        ctx.fillRect(this.boxX - this.bw/2, this.cy - this.bh, this.bw, this.bh);
        
        // Force Vector
        const forceY = this.cy - this.h;
        const forceX = this.boxX - this.bw/2;
        
        if(this.f > 0) {
            ctx.strokeStyle = 'white'; ctx.lineWidth = 3;
            ctx.beginPath(); ctx.moveTo(forceX - 10, forceY); ctx.lineTo(forceX - 10 - (this.f), forceY); ctx.stroke();
            // Arrowhead
            ctx.beginPath(); ctx.arc(forceX - 10, forceY, 3, 0, Math.PI*2); ctx.fill();
        }

        ctx.restore();

        // Status Text
        ctx.font = 'bold 20px sans-serif'; ctx.textAlign='center'; ctx.fillStyle = 'white';
        ctx.fillText(`STATUS: ${this.state}`, width/2, this.cy - 200);
        
        // Debug
        ctx.font = '12px monospace'; ctx.fillStyle='#aaa';
        ctx.fillText(`Torque(Push): ${(this.f*this.h).toFixed(0)} | Torque(Grav): ${(this.mass*10*this.bw/2).toFixed(0)}`, width/2, this.cy - 180);
    }
}


// ==========================================
// SIMULATION 4: ROLLING RACE (Simplified)
// ==========================================
class RaceSim {
    constructor() {
        this.title = "Rolling on Incline";
        this.concept = "a = gsinŒ∏ / (1 + I/MR¬≤). Shape decides winner.";
        this.racers = [
            {n: 'Ring', k: 1.0, c: '#ef4444', x: 0},
            {n: 'Disc', k: 0.5, c: '#3b82f6', x: 0},
            {n: 'Sphere', k: 0.4, c: '#10b981', x: 0}
        ];
        this.running = false;
        this.time = 0;
    }

    resize() { this.cx = 50; this.cy = 100; }

    initUI() {
        const c = document.getElementById('sim-controls');
        c.innerHTML = `
            <div style="font-size:0.85rem; color:#aaa; margin-bottom:10px;">
                I_Ring = MR¬≤ (k=1) <br> I_Disc = 0.5MR¬≤ (k=0.5) <br> I_Sphere = 0.4MR¬≤ (k=0.4)
            </div>
            <button class="action-btn" onclick="currentSim.start()">START RACE</button>
            <button class="action-btn danger" onclick="currentSim.reset()" style="margin-top:10px;">RESET</button>
        `;
    }

    start() { this.running = true; }
    reset() { this.running = false; this.time = 0; this.racers.forEach(r => r.x = 0); }

    update() {
        if(!this.running) return;
        this.time += 0.016;
        
        // a prop to 1/(1+k)
        this.racers.forEach(r => {
            const acc = 200 / (1 + r.k); // Arbitrary scale
            r.x = 0.5 * acc * this.time * this.time;
        });
    }

    draw() {
        const laneH = 80;
        this.racers.forEach((r, i) => {
            const y = 150 + i * laneH;
            
            // Track
            ctx.strokeStyle = '#333'; ctx.beginPath(); ctx.moveTo(50, y+20); ctx.lineTo(width-50, y+20); ctx.stroke();
            
            // Ball
            const bx = 50 + r.x;
            ctx.fillStyle = r.c;
            ctx.beginPath(); ctx.arc(bx, y, 15, 0, Math.PI*2); ctx.fill();
            
            // Rolling Marker
            ctx.strokeStyle = 'white'; ctx.lineWidth=2;
            const angle = bx / 15;
            ctx.beginPath(); ctx.moveTo(bx, y); 
            ctx.lineTo(bx + Math.cos(angle)*15, y + Math.sin(angle)*15); ctx.stroke();

            // Label
            ctx.fillStyle = '#aaa'; ctx.font='12px sans-serif'; ctx.textAlign='left';
            ctx.fillText(`${r.n} (k=${r.k})`, 50, y - 25);
            
            if(bx > width-50) this.running = false;
        });
    }
}

</script>
</body>
</html>
